{
  "originalPath": "src\\components\\AdminControlPanel.tsx",
  "timestamp": "2025-10-15T16:14:05.617Z",
  "hash": "37fd21a64f9e160b6bc9d67ce7cbbe0d88d06d0f8a4ac3946e46bb9dbbf488a7",
  "size": 13006,
  "content": "import React, { useState } from 'react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Badge } from './ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\r\nimport {\r\n  Shield,\r\n  Users,\r\n  Database,\r\n  Activity,\r\n  Settings,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n} from 'lucide-react';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\ninterface SystemStatus {\r\n  database: 'healthy' | 'warning' | 'error';\r\n  api: 'healthy' | 'warning' | 'error';\r\n  storage: 'healthy' | 'warning' | 'error';\r\n  functions: 'healthy' | 'warning' | 'error';\r\n}\r\n\r\nexport default function AdminControlPanel() {\r\n  const [systemStatus, setSystemStatus] = useState<SystemStatus>({\r\n    database: 'healthy',\r\n    api: 'healthy',\r\n    storage: 'warning',\r\n    functions: 'healthy',\r\n  });\r\n  const [activeUsers, setActiveUsers] = useState(12);\r\n  const [totalEmployees, setTotalEmployees] = useState(45);\r\n  const [pendingApprovals, setPendingApprovals] = useState(3);\r\n\r\n  const checkSystemHealth = async () => {\r\n    try {\r\n      // Test database connection\r\n      const { error: dbError } = await supabase\r\n        .from('employees')\r\n        .select('count')\r\n        .limit(1);\r\n\r\n      // Test function availability\r\n      const { error: funcError } = await supabase.functions.invoke(\r\n        'time-clock-manager',\r\n        {\r\n          body: { action: 'health-check' },\r\n        }\r\n      );\r\n\r\n      setSystemStatus(prev => ({\r\n        ...prev,\r\n        database: dbError ? 'error' : 'healthy',\r\n        functions: funcError ? 'warning' : 'healthy',\r\n      }));\r\n    } catch (error) {\r\n      console.error('Health check failed:', error);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return <CheckCircle className='w-4 h-4 text-green-500' />;\r\n      case 'warning':\r\n        return <AlertTriangle className='w-4 h-4 text-yellow-500' />;\r\n      case 'error':\r\n        return <AlertTriangle className='w-4 h-4 text-red-500' />;\r\n      default:\r\n        return <AlertTriangle className='w-4 h-4 text-gray-500' />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'warning':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'error':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className='space-y-6 p-6'>\r\n      <div className='flex items-center justify-end'>\r\n        <div className='flex gap-2'>\r\n          <Button onClick={checkSystemHealth} variant='outline'>\r\n            <Activity className='w-4 h-4 mr-2' />\r\n            Health Check\r\n          </Button>\r\n          <Badge className='bg-red-600 text-white'>ADMIN ACCESS</Badge>\r\n        </div>\r\n      </div>\r\n\r\n      {/* System Overview Cards */}\r\n      <div className='grid grid-cols-1 md:grid-cols-4 gap-4'>\r\n        <Card>\r\n          <CardContent className='p-4'>\r\n            <div className='flex items-center justify-between'>\r\n              <div>\r\n                <p className='text-sm font-medium text-gray-600'>\r\n                  Active Users\r\n                </p>\r\n                <p className='text-2xl font-bold text-blue-600'>\r\n                  {activeUsers}\r\n                </p>\r\n              </div>\r\n              <Users className='w-8 h-8 text-blue-600' />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className='p-4'>\r\n            <div className='flex items-center justify-between'>\r\n              <div>\r\n                <p className='text-sm font-medium text-gray-600'>\r\n                  Total Employees\r\n                </p>\r\n                <p className='text-2xl font-bold text-green-600'>\r\n                  {totalEmployees}\r\n                </p>\r\n              </div>\r\n              <Users className='w-8 h-8 text-green-600' />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className='p-4'>\r\n            <div className='flex items-center justify-between'>\r\n              <div>\r\n                <p className='text-sm font-medium text-gray-600'>\r\n                  Pending Approvals\r\n                </p>\r\n                <p className='text-2xl font-bold text-orange-600'>\r\n                  {pendingApprovals}\r\n                </p>\r\n              </div>\r\n              <AlertTriangle className='w-8 h-8 text-orange-600' />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className='p-4'>\r\n            <div className='flex items-center justify-between'>\r\n              <div>\r\n                <p className='text-sm font-medium text-gray-600'>\r\n                  System Status\r\n                </p>\r\n                <p className='text-sm font-bold text-green-600'>\r\n                  All Systems Operational\r\n                </p>\r\n              </div>\r\n              <CheckCircle className='w-8 h-8 text-green-600' />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Tabs defaultValue='system' className='w-full'>\r\n        <TabsList className='flex overflow-x-auto gap-2 md:grid md:grid-cols-4 md:gap-0'>\r\n          <TabsTrigger value='system' className='flex-shrink-0 md:w-full'>\r\n            <span className='md:hidden'>Sys</span>\r\n            <span className='hidden md:inline'>System Status</span>\r\n          </TabsTrigger>\r\n          <TabsTrigger value='users' className='flex-shrink-0 md:w-full'>\r\n            <span className='md:hidden'>Users</span>\r\n            <span className='hidden md:inline'>User Management</span>\r\n          </TabsTrigger>\r\n          <TabsTrigger value='database' className='flex-shrink-0 md:w-full'>\r\n            <span className='md:hidden'>DB</span>\r\n            <span className='hidden md:inline'>Database</span>\r\n          </TabsTrigger>\r\n          <TabsTrigger value='settings' className='flex-shrink-0 md:w-full'>\r\n            <span className='md:hidden'>Set</span>\r\n            <span className='hidden md:inline'>Settings</span>\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value='system'>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>System Health Monitor</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className='space-y-4'>\r\n                {Object.entries(systemStatus).map(([service, status]) => (\r\n                  <div\r\n                    key={service}\r\n                    className='flex items-center justify-between p-3 border rounded-lg'\r\n                  >\r\n                    <div className='flex items-center gap-3'>\r\n                      {getStatusIcon(status)}\r\n                      <div>\r\n                        <p className='font-medium capitalize'>{service}</p>\r\n                        <p className='text-sm text-gray-600'>\r\n                          {service === 'database' &&\r\n                            'PostgreSQL connection and queries'}\r\n                          {service === 'api' &&\r\n                            'REST API endpoints and authentication'}\r\n                          {service === 'storage' && 'File storage and backups'}\r\n                          {service === 'functions' &&\r\n                            'Edge functions and serverless operations'}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Badge className={getStatusColor(status)}>\r\n                      {status.toUpperCase()}\r\n                    </Badge>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value='users'>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>User Management</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className='space-y-4'>\r\n                <div className='flex justify-between items-center'>\r\n                  <h3 className='text-lg font-medium'>Active Sessions</h3>\r\n                  <Button size='sm'>View All Users</Button>\r\n                </div>\r\n                <div className='grid grid-cols-1 md:grid-cols-2 gap-4'>\r\n                  <div className='p-4 bg-blue-50 rounded-lg'>\r\n                    <h4 className='font-medium text-blue-800'>\r\n                      Administrators\r\n                    </h4>\r\n                    <p className='text-2xl font-bold text-blue-600'>3</p>\r\n                    <p className='text-sm text-blue-600'>Currently online</p>\r\n                  </div>\r\n                  <div className='p-4 bg-green-50 rounded-lg'>\r\n                    <h4 className='font-medium text-green-800'>Employees</h4>\r\n                    <p className='text-2xl font-bold text-green-600'>\r\n                      {activeUsers - 3}\r\n                    </p>\r\n                    <p className='text-sm text-green-600'>Currently online</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value='database'>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Database Management</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className='space-y-4'>\r\n                <div className='grid grid-cols-1 md:grid-cols-3 gap-4'>\r\n                  <div className='p-4 bg-purple-50 rounded-lg'>\r\n                    <h4 className='font-medium text-purple-800'>Tables</h4>\r\n                    <p className='text-2xl font-bold text-purple-600'>15</p>\r\n                    <p className='text-sm text-purple-600'>Active tables</p>\r\n                  </div>\r\n                  <div className='p-4 bg-indigo-50 rounded-lg'>\r\n                    <h4 className='font-medium text-indigo-800'>Records</h4>\r\n                    <p className='text-2xl font-bold text-indigo-600'>2,847</p>\r\n                    <p className='text-sm text-indigo-600'>Total records</p>\r\n                  </div>\r\n                  <div className='p-4 bg-pink-50 rounded-lg'>\r\n                    <h4 className='font-medium text-pink-800'>Storage</h4>\r\n                    <p className='text-2xl font-bold text-pink-600'>156 MB</p>\r\n                    <p className='text-sm text-pink-600'>Database size</p>\r\n                  </div>\r\n                </div>\r\n                <div className='flex gap-2'>\r\n                  <Button variant='outline'>\r\n                    <Database className='w-4 h-4 mr-2' />\r\n                    Backup Database\r\n                  </Button>\r\n                  <Button variant='outline'>\r\n                    <Activity className='w-4 h-4 mr-2' />\r\n                    Performance Report\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value='settings'>\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>System Settings</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className='space-y-4'>\r\n                <div className='flex items-center justify-between p-3 border rounded-lg'>\r\n                  <div>\r\n                    <p className='font-medium'>Automatic Backups</p>\r\n                    <p className='text-sm text-gray-600'>\r\n                      Daily database backups at 2 AM\r\n                    </p>\r\n                  </div>\r\n                  <Badge className='bg-green-100 text-green-800'>Enabled</Badge>\r\n                </div>\r\n                <div className='flex items-center justify-between p-3 border rounded-lg'>\r\n                  <div>\r\n                    <p className='font-medium'>Email Notifications</p>\r\n                    <p className='text-sm text-gray-600'>\r\n                      System alerts and user notifications\r\n                    </p>\r\n                  </div>\r\n                  <Badge className='bg-green-100 text-green-800'>Enabled</Badge>\r\n                </div>\r\n                <div className='flex items-center justify-between p-3 border rounded-lg'>\r\n                  <div>\r\n                    <p className='font-medium'>Maintenance Mode</p>\r\n                    <p className='text-sm text-gray-600'>\r\n                      Disable user access during updates\r\n                    </p>\r\n                  </div>\r\n                  <Badge className='bg-gray-100 text-gray-800'>Disabled</Badge>\r\n                </div>\r\n                <Button className='w-full'>\r\n                  <Settings className='w-4 h-4 mr-2' />\r\n                  Advanced Settings\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n"
}