{
  "originalPath": "src\\components\\AdminControlPanel.tsx",
  "timestamp": "2025-10-13T18:24:26.125Z",
  "hash": "0069f89152ae0dd3e6939be2074f6043914f59758611adf7404be4803d52b588",
  "size": 11647,
  "content": "import React, { useState } from 'react';\r\nimport { Card, CardHeader, CardTitle, CardContent } from './ui/card';\r\nimport { Button } from './ui/button';\r\nimport { Badge } from './ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from './ui/tabs';\r\nimport { Shield, Users, Database, Activity, Settings, AlertTriangle, CheckCircle } from 'lucide-react';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\ninterface SystemStatus {\r\n  database: 'healthy' | 'warning' | 'error';\r\n  api: 'healthy' | 'warning' | 'error';\r\n  storage: 'healthy' | 'warning' | 'error';\r\n  functions: 'healthy' | 'warning' | 'error';\r\n}\r\n\r\nexport default function AdminControlPanel() {\r\n  const [systemStatus, setSystemStatus] = useState<SystemStatus>({\r\n    database: 'healthy',\r\n    api: 'healthy', \r\n    storage: 'warning',\r\n    functions: 'healthy'\r\n  });\r\n  const [activeUsers, setActiveUsers] = useState(12);\r\n  const [totalEmployees, setTotalEmployees] = useState(45);\r\n  const [pendingApprovals, setPendingApprovals] = useState(3);\r\n\r\n  const checkSystemHealth = async () => {\r\n    try {\r\n      // Test database connection\r\n      const { error: dbError } = await supabase.from('employees').select('count').limit(1);\r\n      \r\n      // Test function availability\r\n      const { error: funcError } = await supabase.functions.invoke('time-clock-manager', {\r\n        body: { action: 'health-check' }\r\n      });\r\n\r\n      setSystemStatus(prev => ({\r\n        ...prev,\r\n        database: dbError ? 'error' : 'healthy',\r\n        functions: funcError ? 'warning' : 'healthy'\r\n      }));\r\n    } catch (error) {\r\n      console.error('Health check failed:', error);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy': return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\r\n      case 'warning': return <AlertTriangle className=\"w-4 h-4 text-yellow-500\" />;\r\n      case 'error': return <AlertTriangle className=\"w-4 h-4 text-red-500\" />;\r\n      default: return <AlertTriangle className=\"w-4 h-4 text-gray-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'healthy': return 'bg-green-100 text-green-800';\r\n      case 'warning': return 'bg-yellow-100 text-yellow-800';\r\n      case 'error': return 'bg-red-100 text-red-800';\r\n      default: return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 p-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-3xl font-bold flex items-center gap-2\">\r\n          <Shield className=\"w-8 h-8 text-red-600\" />\r\n          Admin Control Panel\r\n        </h1>\r\n        <div className=\"flex gap-2\">\r\n          <Button onClick={checkSystemHealth} variant=\"outline\">\r\n            <Activity className=\"w-4 h-4 mr-2\" />\r\n            Health Check\r\n          </Button>\r\n          <Badge className=\"bg-red-600 text-white\">ADMIN ACCESS</Badge>\r\n        </div>\r\n      </div>\r\n\r\n      {/* System Overview Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-gray-600\">Active Users</p>\r\n                <p className=\"text-2xl font-bold text-blue-600\">{activeUsers}</p>\r\n              </div>\r\n              <Users className=\"w-8 h-8 text-blue-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-gray-600\">Total Employees</p>\r\n                <p className=\"text-2xl font-bold text-green-600\">{totalEmployees}</p>\r\n              </div>\r\n              <Users className=\"w-8 h-8 text-green-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-gray-600\">Pending Approvals</p>\r\n                <p className=\"text-2xl font-bold text-orange-600\">{pendingApprovals}</p>\r\n              </div>\r\n              <AlertTriangle className=\"w-8 h-8 text-orange-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-gray-600\">System Status</p>\r\n                <p className=\"text-sm font-bold text-green-600\">All Systems Operational</p>\r\n              </div>\r\n              <CheckCircle className=\"w-8 h-8 text-green-600\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"system\" className=\"w-full\">\r\n        <TabsList>\r\n          <TabsTrigger value=\"system\">System Status</TabsTrigger>\r\n          <TabsTrigger value=\"users\">User Management</TabsTrigger>\r\n          <TabsTrigger value=\"database\">Database</TabsTrigger>\r\n          <TabsTrigger value=\"settings\">Settings</TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"system\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>System Health Monitor</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                {Object.entries(systemStatus).map(([service, status]) => (\r\n                  <div key={service} className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {getStatusIcon(status)}\r\n                      <div>\r\n                        <p className=\"font-medium capitalize\">{service}</p>\r\n                        <p className=\"text-sm text-gray-600\">\r\n                          {service === 'database' && 'PostgreSQL connection and queries'}\r\n                          {service === 'api' && 'REST API endpoints and authentication'}\r\n                          {service === 'storage' && 'File storage and backups'}\r\n                          {service === 'functions' && 'Edge functions and serverless operations'}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <Badge className={getStatusColor(status)}>\r\n                      {status.toUpperCase()}\r\n                    </Badge>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"users\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>User Management</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <h3 className=\"text-lg font-medium\">Active Sessions</h3>\r\n                  <Button size=\"sm\">View All Users</Button>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                    <h4 className=\"font-medium text-blue-800\">Administrators</h4>\r\n                    <p className=\"text-2xl font-bold text-blue-600\">3</p>\r\n                    <p className=\"text-sm text-blue-600\">Currently online</p>\r\n                  </div>\r\n                  <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                    <h4 className=\"font-medium text-green-800\">Employees</h4>\r\n                    <p className=\"text-2xl font-bold text-green-600\">{activeUsers - 3}</p>\r\n                    <p className=\"text-sm text-green-600\">Currently online</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"database\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Database Management</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  <div className=\"p-4 bg-purple-50 rounded-lg\">\r\n                    <h4 className=\"font-medium text-purple-800\">Tables</h4>\r\n                    <p className=\"text-2xl font-bold text-purple-600\">15</p>\r\n                    <p className=\"text-sm text-purple-600\">Active tables</p>\r\n                  </div>\r\n                  <div className=\"p-4 bg-indigo-50 rounded-lg\">\r\n                    <h4 className=\"font-medium text-indigo-800\">Records</h4>\r\n                    <p className=\"text-2xl font-bold text-indigo-600\">2,847</p>\r\n                    <p className=\"text-sm text-indigo-600\">Total records</p>\r\n                  </div>\r\n                  <div className=\"p-4 bg-pink-50 rounded-lg\">\r\n                    <h4 className=\"font-medium text-pink-800\">Storage</h4>\r\n                    <p className=\"text-2xl font-bold text-pink-600\">156 MB</p>\r\n                    <p className=\"text-sm text-pink-600\">Database size</p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button variant=\"outline\">\r\n                    <Database className=\"w-4 h-4 mr-2\" />\r\n                    Backup Database\r\n                  </Button>\r\n                  <Button variant=\"outline\">\r\n                    <Activity className=\"w-4 h-4 mr-2\" />\r\n                    Performance Report\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent value=\"settings\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>System Settings</CardTitle>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                  <div>\r\n                    <p className=\"font-medium\">Automatic Backups</p>\r\n                    <p className=\"text-sm text-gray-600\">Daily database backups at 2 AM</p>\r\n                  </div>\r\n                  <Badge className=\"bg-green-100 text-green-800\">Enabled</Badge>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                  <div>\r\n                    <p className=\"font-medium\">Email Notifications</p>\r\n                    <p className=\"text-sm text-gray-600\">System alerts and user notifications</p>\r\n                  </div>\r\n                  <Badge className=\"bg-green-100 text-green-800\">Enabled</Badge>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 border rounded-lg\">\r\n                  <div>\r\n                    <p className=\"font-medium\">Maintenance Mode</p>\r\n                    <p className=\"text-sm text-gray-600\">Disable user access during updates</p>\r\n                  </div>\r\n                  <Badge className=\"bg-gray-100 text-gray-800\">Disabled</Badge>\r\n                </div>\r\n                <Button className=\"w-full\">\r\n                  <Settings className=\"w-4 h-4 mr-2\" />\r\n                  Advanced Settings\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}"
}