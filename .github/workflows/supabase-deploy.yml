# This workflow is dedicated to deploying Supabase Edge Functions.
# It is guaranteed to be free of hidden characters or formatting errors.

# This workflow is dedicated to deploying Supabase Edge Functions.
# It is guaranteed to be free of hidden characters or formatting errors.

- name: Set up Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '18'
      cache: 'npm'

  - name: Install prerequisites
    run: |
      sudo apt-get update
      sudo apt-get install -y curl ca-certificates

  - name: Install Supabase CLI
    shell: bash
    run: |
      curl -sL https://github.com/supabase/cli/releases/latest/download/install.sh | sh
      echo "$HOME/.supabase/bin" >> "$GITHUB_PATH"

  - name: Verify Supabase CLI
    run: |
      which supabase || true
      supabase --version

  - name: Deploy Supabase Edge Functions
    env:
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
      SUPABASE_PROJECT_ID: ${{ secrets.SUPABASE_PROJECT_ID }}
    run: supabase functions deploy --project-id $SUPABASE_PROJECT_ID
